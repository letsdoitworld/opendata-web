import React, {Component} from 'react';
import ReactCountryFlag from 'react-country-flag';
import EventType from '../EventType';
import * as EventSystem from '../EventSystem';
import TrashPoint from '../TrashPoint';
// import {getJSOnFromApiAsync} from '../utils/ResourceConnector';
import '../css/details/Details.css';

export default class CountryList extends Component {
    constructor(props) {
        super(props);
        this.state = {};
        // this.jsonData=getJSOnFromApiAsync('https://opendata.wemakesoftware.eu:3000/api/countries');
        // this.jsonStr=JSON.stringify(this.jsonData);
        this.jsonData = [{count: '436', country_code: 'BM', tpr: '66.6911404796867352'}, {count: '13217', country_code: 'SI', tpr: '64.0035408480796032'}, {count: '49', country_code: 'VG', tpr: '15.9812139199634715'}, {count: '4156', country_code: 'AL', tpr: '14.4501184068292456'}, {count: '87', country_code: 'DM', tpr: '11.8298138504004460'}, {count: '25', country_code: 'PW', tpr: '11.6262847044598428'}, {count: '5447', country_code: 'SK', tpr: '10.0298335530063906'}, {count: '284', country_code: 'BB', tpr: '9.9650521410826819'}, {count: '419', country_code: 'MT', tpr: '9.5789382238499559'}, {count: '47', country_code: 'KN', tpr: '8.5733569252658653'}, {count: '912', country_code: 'EE', tpr: '6.9311972275211090'}, {count: '149023', country_code: 'US', tpr: '4.6118944999895444'}, {count: '1781', country_code: 'HR', tpr: '4.2665335361274297'}, {count: '12054', country_code: 'CA', tpr: '3.3239022822364198'}, {count: '118', country_code: 'BZ', tpr: '3.2156619085770969'}, {count: '6207', country_code: 'RO', tpr: '3.1508714619068930'}, {count: '32', country_code: 'VC', tpr: '2.9185629725563875'}, {count: '102', country_code: 'BS', tpr: '2.6071486994928840'}, {count: '21', country_code: 'AG', tpr: '2.0799698899596882'}, {count: '12', country_code: 'KY', tpr: '1.9748210318439891'}, {count: '21', country_code: 'GD', tpr: '1.9568195160133064'}, {count: '214', country_code: 'TT', tpr: '1.5678092137363531'}, {count: '24', country_code: 'GU', tpr: '1.4733326785188095'}, {count: '5', country_code: 'TC', tpr: '1.4326647564469914'}, {count: '25', country_code: 'LC', tpr: '1.4043760357273263'}, {count: '56', country_code: 'BN', tpr: '1.3232639249898392'}, {count: '1368', country_code: 'CZ', tpr: '1.2946782289256101'}, {count: '12', country_code: 'SC', tpr: '1.2674672835007446'}, {count: '360', country_code: 'JM', tpr: '1.2494121689274664'}, {count: '546', country_code: 'NO', tpr: '1.0427506769762751'}, {count: '28', country_code: 'VU', tpr: '1.0354952995909794'}, {count: '129', country_code: 'MU', tpr: '1.0209953042130698'}, {count: '719', country_code: 'CH', tpr: '0.85877273373876802303'}, {count: '176', country_code: 'MK', tpr: '0.84566352393756312446'}, {count: '7', country_code: 'IM', tpr: '0.83595065502704897477'}, {count: '267', country_code: 'BA', tpr: '0.75920946674491926788'}, {count: '32', country_code: 'MV', tpr: '0.74809003263542767372'}, {count: '78', country_code: 'CY', tpr: '0.66659544920414485632'}, {count: '309', country_code: 'CR', tpr: '0.63615929428728953730'}, {count: '2', country_code: 'GI', tpr: '0.58126017205301092769'}, {count: '923', country_code: 'EC', tpr: '0.56331777201046709113'}, {count: '3044', country_code: 'GB', tpr: '0.46405576352608594804'}, {count: '27', country_code: 'ME', tpr: '0.43387224551384132810'}, {count: '75', country_code: 'LV', tpr: '0.38274347460650143376'}, {count: '2', country_code: 'MH', tpr: '0.37688915689895601704'}, {count: '132', country_code: 'PA', tpr: '0.32720898912501093795'}, {count: '175', country_code: 'DK', tpr: '0.30551622640323602787'}, {count: '27', country_code: 'FJ', tpr: '0.30041390360051626686'}, {count: '109', country_code: 'GG', tpr: '0.29306589949721721829'}, {count: '301', country_code: 'PT', tpr: '0.29151266210912607022'}, {count: '271', country_code: 'HU', tpr: '0.27613548490766732460'}, {count: '290', country_code: 'GR', tpr: '0.26925345579847065894'}, {count: '439', country_code: 'NL', tpr: '0.25777563467121040751'}, {count: '5', country_code: 'ST', tpr: '0.25011255064779150618'}, {count: '1499', country_code: 'IT', tpr: '0.24724754434035856139'}, {count: '135', country_code: 'NI', tpr: '0.21951476505090791307'}, {count: '779', country_code: 'PL', tpr: '0.20516149989332392101'}, {count: '4', country_code: 'WS', tpr: '0.20499679692504804612'}, {count: '210', country_code: 'DO', tpr: '0.19720548558047575542'}, {count: '1315', country_code: 'FR', tpr: '0.19658493840949031356'}, {count: '2284', country_code: 'MX', tpr: '0.17908047866518366495'}, {count: '2', country_code: 'KI', tpr: '0.17483281611958564623'}, {count: '415', country_code: 'AU', tpr: '0.17141104206802837526'}, {count: '80', country_code: 'IE', tpr: '0.16842895992801346253'}, {count: '159', country_code: 'SE', tpr: '0.16023242771779139250'}, {count: '75', country_code: 'NZ', tpr: '0.15980567629762209154'}, {count: '278', country_code: 'CL', tpr: '0.15522267921714614282'}, {count: '87', country_code: 'SG', tpr: '0.15515535777309616797'}, {count: '131', country_code: 'AT', tpr: '0.15003199346364432751'}, {count: '93', country_code: 'SV', tpr: '0.14657852621438732855'}, {count: '692', country_code: 'ZA', tpr: '0.12353729477567742756'}, {count: '569', country_code: 'ES', tpr: '0.12240630663106801568'}, {count: '105', country_code: 'BY', tpr: '0.11050847157943127920'}, {count: '90', country_code: 'IL', tpr: '0.10531242686637023169'}, {count: '26', country_code: 'NA', tpr: '0.10485084362585508888'}, {count: '96', country_code: 'JO', tpr: '0.10152496847966994233'}, {count: '785', country_code: 'DE', tpr: '0.09516553966825802038'}, {count: '1', country_code: 'TO', tpr: '0.09335150575978790538'}, {count: '5', country_code: 'SR', tpr: '0.08954667889277322483'}, {count: '1108', country_code: 'JP', tpr: '0.08724786538215025687'}, {count: '149', country_code: 'KZ', tpr: '0.08373422263198915928'}, {count: '57', country_code: 'BG', tpr: '0.07996832693072301749'}, {count: '1099', country_code: 'RU', tpr: '0.07613840634874870721'}, {count: '22', country_code: 'AM', tpr: '0.07521840690149397432'}, {count: '24', country_code: 'UY', tpr: '0.06968628974513981683'}, {count: '649', country_code: 'VN', tpr: '0.06862708772271763437'}, {count: '162', country_code: 'TW', tpr: '0.06840113941098005490'}, {count: '189', country_code: 'MZ', tpr: '0.06555790330701813658'}, {count: '206', country_code: 'VE', tpr: '0.06525558537918832759'}, {count: '38', country_code: 'LB', tpr: '0.06326302702263551107'}, {count: '132', country_code: 'LK', tpr: '0.06225534122529830684'}, {count: '642', country_code: 'PH', tpr: '0.06213691643055122355'}, {count: '177', country_code: 'NP', tpr: '0.06107076511076183847'}, {count: '68', country_code: 'BE', tpr: '0.05997278646618822494'}, {count: '89', country_code: 'ZW', tpr: '0.05510712391462185182'}, {count: '270', country_code: 'KR', tpr: '0.05268734022929959772'}, {count: '15', country_code: 'LT', tpr: '0.05229704302059352960'}, {count: '4', country_code: 'GY', tpr: '0.05172616684533746798'}, {count: '16', country_code: 'GE', tpr: '0.04301884763261904122'}, {count: '6', country_code: 'BH', tpr: '0.04210021113255882978'}, {count: '195', country_code: 'KE', tpr: '0.04023807154234199649'}, {count: '5', country_code: 'TL', tpr: '0.03941132098077436940'}, {count: '42', country_code: 'HT', tpr: '0.03871919127778309398'}, {count: '170', country_code: 'UA', tpr: '0.03777387867407908673'}, {count: '15', country_code: 'KW', tpr: '0.03701342156017000511'}, {count: '251', country_code: 'TH', tpr: '0.03644890965047180137'}, {count: '114', country_code: 'PE', tpr: '0.03587857293542653124'}, {count: '1', country_code: 'PF', tpr: '0.03568777479586592817'}, {count: '33', country_code: 'AE', tpr: '0.03560019556374096348'}, {count: '111', country_code: 'MY', tpr: '0.03559145054880573850'}, {count: '1', country_code: 'IS', tpr: '0.02981167961984146149'}, {count: '229', country_code: 'TR', tpr: '0.02880052986938167375'}, {count: '6', country_code: 'LS', tpr: '0.02722544163069505191'}, {count: '42', country_code: 'GT', tpr: '0.02532795327402692566'}, {count: '27', country_code: 'BJ', tpr: '0.02483375639630186737'}, {count: '6', country_code: 'QA', tpr: '0.02334808413404290755'}, {count: '11', country_code: 'FI', tpr: '0.02001709459878736441'}, {count: '111', country_code: 'TZ', tpr: '0.01997401542544625864'}, {count: '6', country_code: 'MN', tpr: '0.01981899968223537176'}, {count: '378', country_code: 'BR', tpr: '0.01820345700503578412'}, {count: '5', country_code: 'JE', tpr: '0.01735294679065925580'}, {count: '1', country_code: 'SB', tpr: '0.01668282119852724054'}, {count: '10', country_code: 'KG', tpr: '0.01644872111193354717'}, {count: '16', country_code: 'AZ', tpr: '0.01639711853435995692'}, {count: '71', country_code: 'AR', tpr: '0.01619251116884159459'}, {count: '25', country_code: 'KH', tpr: '0.01586055904029660514'}, {count: '11', country_code: 'RS', tpr: '0.01558444060783852026'}, {count: '5', country_code: 'MD', tpr: '0.01407675887694491539'}, {count: '9', country_code: 'PY', tpr: '0.01338228672947023393'}, {count: '338', country_code: 'ID', tpr: '0.01294446545515865595'}, {count: '1', country_code: 'BT', tpr: '0.01253501971131849605'}, {count: '5', country_code: 'MS', tpr: '0.01162515478893601468'}, {count: '5', country_code: 'OM', tpr: '0.01130004280456214368'}, {count: '10', country_code: 'HN', tpr: '0.01097349494950381697'}, {count: '50', country_code: 'CO', tpr: '0.01027677006625166466'}, {count: '10', country_code: 'BO', tpr: '0.00918452275658387922'}, {count: '6', country_code: 'LA', tpr: '0.00887790264876664477'}, {count: '4', country_code: 'CK', tpr: '0.00780362794565007245'}, {count: '23', country_code: 'SA', tpr: '0.00712610702910831921'}, {count: '20', country_code: 'GH', tpr: '0.00709050691735673843'}, {count: '8', country_code: 'TN', tpr: '0.00701554504471006857'}, {count: '64', country_code: 'EG', tpr: '0.00668835637937155806'}, {count: '22', country_code: 'AF', tpr: '0.00634810124829062946'}, {count: '15', country_code: 'YE', tpr: '0.00543789304411186210'}, {count: '1', country_code: 'GM', tpr: '0.00490556541301672160'}, {count: '2', country_code: 'MR', tpr: '0.00465006191557440587'}, {count: '4', country_code: 'TJ', tpr: '0.00457930445173647797'}, {count: '5', country_code: 'CU', tpr: '0.00435692562083140249'}, {count: '7', country_code: 'ZM', tpr: '0.00421905578736923187'}, {count: '66', country_code: 'NG', tpr: '0.00354858474912903751'}, {count: '457', country_code: 'CN', tpr: '0.00331480091247692514'}, {count: '383', country_code: 'IN', tpr: '0.00289237490935784131'}, {count: '10', country_code: 'MA', tpr: '0.00283472536301918208'}, {count: '5', country_code: 'MW', tpr: '0.00276371736567988138'}, {count: '39', country_code: 'BD', tpr: '0.00239334928735877091'}, {count: '7', country_code: 'IQ', tpr: '0.00188159033735624515'}, {count: '1', country_code: 'TM', tpr: '0.00176599069252265413'}, {count: '7', country_code: 'DZ', tpr: '0.00172388096237477113'}, {count: '4', country_code: 'CI', tpr: '0.00168805438607382140'}, {count: '4', country_code: 'MG', tpr: '0.00160677732247510710'}, {count: '1', country_code: 'LY', tpr: '0.00158900333420569616'}, {count: '29', country_code: 'PK', tpr: '0.00150100819097064278'}, {count: '3', country_code: 'NE', tpr: '0.00145116910294579105'}, {count: '2', country_code: 'TD', tpr: '0.00138383950838271161'}, {count: '1', country_code: 'SL', tpr: '0.00135204747309087517'}, {count: '2', country_code: 'SN', tpr: '0.00129772261360815292'}, {count: '10', country_code: 'IR', tpr: '0.00124568016802929959'}, {count: '3', country_code: 'UZ', tpr: '0.00094197733602529523'}, {count: '1', country_code: 'RW', tpr: '0.00083910159741449303'}, {count: '1', country_code: 'GN', tpr: '0.00080671678851854852'}, {count: '4', country_code: 'MM', tpr: '0.00075635494625786110'}, {count: '1', country_code: 'SO', tpr: '0.00069842176237512568'}, {count: '1', country_code: 'SY', tpr: '0.00054258026104947068'}, {count: '1', country_code: 'UG', tpr: '0.00024103375521069785'}, {count: '1', country_code: 'ET', tpr: '0.000097653202152010958720'}, {count: '1949', country_code: 'XK', tpr: null}];
        this.jsonStr = JSON.stringify(this.jsonData);
        this.countries = JSON.parse(this.jsonStr);
    }

    componentDidMount() {
        EventSystem.subscribe(
            EventType.eventType.TRASHPOINT_SELECTED,
            this.trashPointSelected.bind(this));
    }

    trashPointSelected(trashPoint: TrashPoint) {
        this.setState({trashPoint});
    }

    render() {
        return (
            <div className="details-container">
                <div className="row tpr">
                    <ReactCountryFlag code="JM" svg />
                    <a href="#" className="previous">&laquo; Back to intro</a>
                    <table>
                        <tbody>{this.countries.map((item, key) => (
                            <tr key={key}>
                                <td> <ReactCountryFlag code={item.country_code} svg /></td>
                                <td>{item.country_code}</td>
                            </tr>
                        ))}</tbody>
                    </table>
                    <p>{this.countries[0].count}</p>
                </div>
            </div>
        );
    }
}
